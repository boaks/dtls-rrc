<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Return Routability Check for DTLS 1.2 and DTLS 1.3</title>
<meta content="Hannes Tschofenig" name="author">
<meta content="Thomas Fossati" name="author">
<meta content="
       This document specifies a return routability check for use in context of the
Connection ID (CID) construct for the Datagram Transport Layer Security (DTLS)
protocol versions 1.2 and 1.3. 
    " name="description">
<meta content="xml2rfc 3.12.6" name="generator">
<meta content="DTLS, RRC, CID" name="keyword">
<meta content="draft-ietf-tls-dtls-rrc-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.6
    Python 3.9.7
    appdirs 1.4.4
    ConfigArgParse 1.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.5
    MarkupSafe 2.0.1
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 52.0.0
    six 1.16.0
-->
<link href="draft-ietf-tls-dtls-rrc.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines */
  line-height: 0;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow, svg + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
/* Trick: a prefix match works because only black and white are allowed */
svg [stroke="black"], svg [stroke^="#000"] {
  stroke: var(--text-color);
}
svg [stroke="white"], svg [stroke^="#fff"] {
  stroke: var(--background-color);
}
svg [fill="black"], svg [fill^="#000"], svg :not([fill]) {
  fill: var(--text-color);
}
svg [stroke="fill"], svg [fill^="#fff"] {
  fill: var(--background-color);
}
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DTLS Return Routability Check</td>
<td class="right">May 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tschofenig &amp; Fossati</td>
<td class="center">Expires 12 November 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TLS</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-tls-dtls-rrc-latest</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc6347" class="eref">6347</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-05-11" class="published">11 May 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-11-12">12 November 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Tschofenig, <span class="editor">Ed.</span>
</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">T. Fossati</div>
<div class="org">Arm Limited</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Return Routability Check for DTLS 1.2 and DTLS 1.3</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a return routability check for use in context of the
Connection ID (CID) construct for the Datagram Transport Layer Security (DTLS)
protocol versions 1.2 and 1.3.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  Transport Layer Security Working Group mailing list (tls@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tls/">https://mailarchive.ietf.org/arch/browse/tls/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/tlswg/dtls-rrc">https://github.com/tlswg/dtls-rrc</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 12 November 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions-and-terminology" class="xref">Conventions and Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-rrc-extension" class="xref">RRC Extension</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-the-return-routability-chec" class="xref">The Return Routability Check Message</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-off-path-packet-forwarding" class="xref">Off-Path Packet Forwarding</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-path-validation-procedure" class="xref">Path Validation Procedure</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-enhanced-path-validation-pr" class="xref">Enhanced Path Validation Procedure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-path-challenge-requirements" class="xref">Path Challenge Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-path-response-drop-requirem" class="xref">Path Response/Drop Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-timer-choice" class="xref">Timer Choice</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-example" class="xref">Example</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-and-privacy-consid" class="xref">Security and Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-new-tls-contenttype" class="xref">New TLS ContentType</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-new-tls-extensiontype" class="xref">New TLS ExtensionType</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="xref">10.3</a>.  <a href="#name-new-rrc-message-type-sub-re" class="xref">New RRC Message Type Sub-registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-open-issues" class="xref">Open Issues</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="xref">13.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="xref">13.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-history" class="xref">History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">In "classical" DTLS, selecting a security context of an incoming DTLS record is
accomplished with the help of the 5-tuple, i.e. source IP address, source port,
transport protocol, destination IP address, and destination port.  Changes to
this 5 tuple can happen for a variety reasons over the lifetime of the DTLS
session.  In the IoT context, NAT rebinding is common with sleepy devices.
Other examples include end host mobility and multi-homing.  Without CID, if the
source IP address and/or source port changes during the lifetime of an ongoing
DTLS session then the receiver will be unable to locate the correct security
context.  As a result, the DTLS handshake has to be re-run.  Of course, it is
not necessary to re-run the full handshake if session resumption is supported
and negotiated.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">A CID is an identifier carried in the record layer header of a DTLS datagram
that gives the receiver additional information for selecting the appropriate
security context.  The CID mechanism has been specified in <span>[<a href="#RFC9146" class="xref">RFC9146</a>]</span> for
DTLS 1.2 and in <span>[<a href="#RFC9147" class="xref">RFC9147</a>]</span> for DTLS 1.3.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Section 6 of <span>[<a href="#RFC9146" class="xref">RFC9146</a>]</span> describes how the use of CID increases the attack
surface by providing both on-path and off-path attackers an opportunity for
(D)DoS.  It then goes on describing the steps a DTLS principal must take when a
record with a CID is received that has a source address (and/or port) different
from the one currently associated with the DTLS connection.  However, the
actual mechanism for ensuring that the new peer address is willing to receive
and process DTLS records is left open.  This document standardizes a return
routability check (RRC) as part of the DTLS protocol itself.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The return routability check is performed by the receiving peer before the
CID-to-IP address/port binding is updated in that peer's session state
database.  This is done in order to provide more confidence to the receiving
peer that the sending peer is reachable at the indicated address and port.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Note however that, irrespective of CID, if RRC has been successfully negotiated
by the peers, path validation can be used at any time by either endpoint. For
instance, an endpoint might use RRC to check that a peer is still in possession
of its address after a period of quiescence.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-2">
      <h2 id="name-conventions-and-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document assumes familiarity with the CID format and protocol defined for
DTLS 1.2 <span>[<a href="#RFC9146" class="xref">RFC9146</a>]</span> and for DTLS 1.3 <span>[<a href="#RFC9147" class="xref">RFC9147</a>]</span>.  The presentation language
used in this document is described in Section 4 of <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">This document reuses the definition of "anti-amplification limit" from
<span>[<a href="#RFC9000" class="xref">RFC9000</a>]</span> to mean three times the amount of data received from an
unvalidated address.  This includes all DTLS records originating from that
source address, excluding discarded ones.<a href="#section-2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rrc-extension">
<section id="section-3">
      <h2 id="name-rrc-extension">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-rrc-extension" class="section-name selfRef">RRC Extension</a>
      </h2>
<p id="section-3-1">The use of RRC is negotiated via the <code>rrc</code> DTLS-only extension.  On connecting,
the client includes the <code>rrc</code> extension in its ClientHello if it wishes to use
RRC.  If the server is capable of meeting this requirement, it responds with a
<code>rrc</code> extension in its ServerHello.  The <code>extension_type</code> value for this
extension is TBD1 and the <code>extension_data</code> field of this extension is empty.
The client and server <span class="bcp14">MUST NOT</span> use RRC unless both sides have successfully
exchanged <code>rrc</code> extensions.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Note that the RRC extension applies to both DTLS 1.2 and DTLS 1.3.<a href="#section-3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-return-routability-check-message">
<section id="section-4">
      <h2 id="name-the-return-routability-chec">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-the-return-routability-chec" class="section-name selfRef">The Return Routability Check Message</a>
      </h2>
<p id="section-4-1">When a record with CID is received that has the source address of the enclosing
UDP datagram different from the one previously associated with that CID, the
receiver <span class="bcp14">MUST NOT</span> update its view of the peer's IP address and port number with
the source specified in the UDP datagram before cryptographically validating
the enclosed record(s) but instead perform a return routability check.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-2">
<pre>
enum {
    invalid(0),
    change_cipher_spec(20),
    alert(21),
    handshake(22),
    application_data(23),
    heartbeat(24),  /* RFC 6520 */
    return_routability_check(TBD2), /* NEW */
    (255)
} ContentType;

uint64 Cookie;

enum {
    path_challenge(0),
    path_response(1),
    path_drop(2),
    reserved(3..255)
} rrc_msg_type;

struct {
    rrc_msg_type msg_type;
    select (return_routability_check.msg_type) {
        case path_challenge: Cookie;
        case path_response:  Cookie;
        case path_drop:      Cookie;
    };
} return_routability_check;
</pre><a href="#section-4-2" class="pilcrow">¶</a>
</div>
<p id="section-4-3">The cookie is a 8-byte field containing arbitrary data.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The <code>return_routability_check</code> message <span class="bcp14">MUST</span> be authenticated and encrypted using
the currently active security context.<a href="#section-4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="off-path">
<section id="section-5">
      <h2 id="name-off-path-packet-forwarding">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-off-path-packet-forwarding" class="section-name selfRef">Off-Path Packet Forwarding</a>
      </h2>
<p id="section-5-1">An off-path attacker that can observe packets might forward copies of
genuine packets to endpoints over a different path. If the copied packet arrives before
the genuine packet, this will appear as a path change, like in a genuine NAT rebinding occurrence. Any genuine
packet will be discarded as a duplicate. If the attacker is able to
continue forwarding packets, it might be able to cause migration to a
path via the attacker. This places the attacker on-path, giving it
the ability to observe or drop all subsequent packets.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">This style of attack relies on the attacker using a path that has
the same or better characteristics (e.g., due to a more favourable service level agreements) as the direct path between
endpoints. The attack is more reliable if relatively few packets are
sent or if packet loss coincides with the attempted attack.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">A data packet received on the original path that increases the
maximum received packet number will cause the endpoint to move back
to that path. Therefore, eliciting packets on this path increases the
likelihood that the attack is unsuccessful. Note however that, unlike QUIC,
DTLS has no "non-probing" packets so this would require application specific
mechanisms.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4"><a href="#fig-off-path" class="xref">Figure 1</a> illustrates the case where a receiver receives a
packet with a new source IP address and/or new port number. In order
to determine whether this path change was not triggered
by an off-path attacker, the receiver will send a RRC message of type
<code>path_challenge</code> (1) on the old path.<a href="#section-5-4" class="pilcrow">¶</a></p>
<span id="name-off-path-packet-forwarding-"></span><div id="fig-off-path">
<figure id="figure-1">
        <div id="section-5-5.1">
          <div class="alignCenter art-svg artwork" id="section-5-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="368" width="256" viewBox="0 0 256 368" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 64,80 L 64,176" fill="none" stroke="black"></path>
              <path d="M 64,208 L 64,304" fill="none" stroke="black"></path>
              <path d="M 112,48 L 112,112" fill="none" stroke="black"></path>
              <path d="M 112,272 L 112,336" fill="none" stroke="black"></path>
              <path d="M 200,48 L 200,112" fill="none" stroke="black"></path>
              <path d="M 200,272 L 200,336" fill="none" stroke="black"></path>
              <path d="M 248,80 L 248,304" fill="none" stroke="black"></path>
              <path d="M 112,48 L 200,48" fill="none" stroke="black"></path>
              <path d="M 64,80 L 112,80" fill="none" stroke="black"></path>
              <path d="M 200,80 L 248,80" fill="none" stroke="black"></path>
              <path d="M 112,112 L 200,112" fill="none" stroke="black"></path>
              <path d="M 24,176 L 120,176" fill="none" stroke="black"></path>
              <path d="M 8,208 L 104,208" fill="none" stroke="black"></path>
              <path d="M 112,272 L 200,272" fill="none" stroke="black"></path>
              <path d="M 64,304 L 112,304" fill="none" stroke="black"></path>
              <path d="M 200,304 L 248,304" fill="none" stroke="black"></path>
              <path d="M 112,336 L 200,336" fill="none" stroke="black"></path>
              <path d="M 8,208 L 24,176" fill="none" stroke="black"></path>
              <path d="M 104,208 L 120,176" fill="none" stroke="black"></path>
              <g class="text">
                <text x="72" y="36">new</text>
                <text x="240" y="36">old</text>
                <text x="76" y="52">path</text>
                <text x="236" y="52">path</text>
                <text x="156" y="84">Receiver</text>
                <text x="64" y="196">Attacker?</text>
                <text x="156" y="308">Sender</text>
              </g>
            </svg><a href="#section-5-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-off-path-packet-forwarding-" class="selfRef">Off-Path Packet Forwarding Scenario</a>
        </figcaption></figure>
</div>
<p id="section-5-6">Three cases need to be considered:<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">Case 1: The old path is dead (e.g., due to a NAT rebinding), which leads to a
timeout of (1).<a href="#section-5-7" class="pilcrow">¶</a></p>
<p id="section-5-8">As shown in <a href="#fig-old-path-dead" class="xref">Figure 2</a>, a <code>path_challenge</code> (2) needs to be sent on
the new path.  If the sender replies with a <code>path_response</code> on the new path
(3), the switch to the new path is considered legitimate.<a href="#section-5-8" class="pilcrow">¶</a></p>
<span id="name-old-path-is-dead"></span><div id="fig-old-path-dead">
<figure id="figure-2">
        <div id="section-5-9.1">
          <div class="alignCenter art-svg artwork" id="section-5-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="368" width="384" viewBox="0 0 384 368" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 80,64 L 80,112" fill="none" stroke="black"></path>
              <path d="M 80,144 L 80,320" fill="none" stroke="black"></path>
              <path d="M 96,80 L 96,176" fill="none" stroke="black"></path>
              <path d="M 96,208 L 96,304" fill="none" stroke="black"></path>
              <path d="M 112,96 L 112,224" fill="none" stroke="black"></path>
              <path d="M 112,256 L 112,288" fill="none" stroke="black"></path>
              <path d="M 144,48 L 144,112" fill="none" stroke="black"></path>
              <path d="M 144,272 L 144,336" fill="none" stroke="black"></path>
              <path d="M 232,48 L 232,112" fill="none" stroke="black"></path>
              <path d="M 232,272 L 232,336" fill="none" stroke="black"></path>
              <path d="M 296,64 L 296,112" fill="none" stroke="black"></path>
              <path d="M 296,144 L 296,176" fill="none" stroke="black"></path>
              <path d="M 144,48 L 232,48" fill="none" stroke="black"></path>
              <path d="M 80,64 L 136,64" fill="none" stroke="black"></path>
              <path d="M 232,64 L 296,64" fill="none" stroke="black"></path>
              <path d="M 96,80 L 144,80" fill="none" stroke="black"></path>
              <path d="M 112,96 L 144,96" fill="none" stroke="black"></path>
              <path d="M 144,112 L 232,112" fill="none" stroke="black"></path>
              <path d="M 56,176 L 72,176" fill="none" stroke="black"></path>
              <path d="M 88,176 L 104,176" fill="none" stroke="black"></path>
              <path d="M 120,176 L 288,176" fill="none" stroke="black"></path>
              <path d="M 304,176 L 320,176" fill="none" stroke="black"></path>
              <path d="M 40,208 L 72,208" fill="none" stroke="black"></path>
              <path d="M 88,208 L 104,208" fill="none" stroke="black"></path>
              <path d="M 120,208 L 304,208" fill="none" stroke="black"></path>
              <path d="M 144,272 L 232,272" fill="none" stroke="black"></path>
              <path d="M 112,288 L 136,288" fill="none" stroke="black"></path>
              <path d="M 96,304 L 144,304" fill="none" stroke="black"></path>
              <path d="M 80,320 L 144,320" fill="none" stroke="black"></path>
              <path d="M 144,336 L 232,336" fill="none" stroke="black"></path>
              <path d="M 40,208 L 56,176" fill="none" stroke="black"></path>
              <path d="M 304,208 L 320,176" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="304,176 292,170.4 292,181.6" fill="black" transform="rotate(90,296,176)"></polygon>
              <polygon class="arrowhead" points="144,288 132,282.4 132,293.6" fill="black" transform="rotate(0,136,288)"></polygon>
              <polygon class="arrowhead" points="144,64 132,58.4 132,69.6" fill="black" transform="rotate(0,136,64)"></polygon>
              <g class="text">
                <text x="88" y="36">new</text>
                <text x="288" y="36">old</text>
                <text x="92" y="52">path</text>
                <text x="284" y="52">path</text>
                <text x="188" y="84">Receiver</text>
                <text x="260" y="84">......</text>
                <text x="280" y="100">.</text>
                <text x="280" y="116">.</text>
                <text x="24" y="132">path-</text>
                <text x="80" y="132">3</text>
                <text x="280" y="132">.</text>
                <text x="296" y="132">1</text>
                <text x="328" y="132">path-</text>
                <text x="36" y="148">response</text>
                <text x="280" y="148">.</text>
                <text x="344" y="148">challenge</text>
                <text x="280" y="164">.</text>
                <text x="184" y="196">NAT</text>
                <text x="296" y="196">X</text>
                <text x="352" y="196">timeout</text>
                <text x="280" y="228">.</text>
                <text x="112" y="244">2</text>
                <text x="144" y="244">path-</text>
                <text x="280" y="244">.</text>
                <text x="160" y="260">challenge</text>
                <text x="280" y="260">.</text>
                <text x="280" y="276">.</text>
                <text x="280" y="292">.</text>
                <text x="188" y="308">Sender</text>
                <text x="260" y="308">.....'</text>
              </g>
            </svg><a href="#section-5-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-old-path-is-dead" class="selfRef">Old path is dead</a>
        </figcaption></figure>
</div>
<p id="section-5-10">Case 2: The old path is alive but not preferred.<a href="#section-5-10" class="pilcrow">¶</a></p>
<p id="section-5-11">This case is shown in <a href="#fig-old-path-not-preferred" class="xref">Figure 3</a> whereby the sender
replies with a <code>path_drop</code> message (2) on the old path.  This triggers
the receiver to send a <code>path_challenge</code> (3) on the new path. The sender
will reply with a <code>path_response</code> (4) on the new path, thus providing
confirmation for the path migration.<a href="#section-5-11" class="pilcrow">¶</a></p>
<span id="name-old-path-is-not-preferred"></span><div id="fig-old-path-not-preferred">
<figure id="figure-3">
        <div id="section-5-12.1">
          <div class="alignCenter art-svg artwork" id="section-5-12.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="352" width="424" viewBox="0 0 424 352" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 104,64 L 104,112" fill="none" stroke="black"></path>
              <path d="M 104,144 L 104,320" fill="none" stroke="black"></path>
              <path d="M 120,80 L 120,176" fill="none" stroke="black"></path>
              <path d="M 120,216 L 120,304" fill="none" stroke="black"></path>
              <path d="M 136,96 L 136,224" fill="none" stroke="black"></path>
              <path d="M 136,256 L 136,288" fill="none" stroke="black"></path>
              <path d="M 168,48 L 168,112" fill="none" stroke="black"></path>
              <path d="M 168,272 L 168,336" fill="none" stroke="black"></path>
              <path d="M 256,48 L 256,112" fill="none" stroke="black"></path>
              <path d="M 256,272 L 256,336" fill="none" stroke="black"></path>
              <path d="M 288,96 L 288,112" fill="none" stroke="black"></path>
              <path d="M 288,144 L 288,288" fill="none" stroke="black"></path>
              <path d="M 304,80 L 304,176" fill="none" stroke="black"></path>
              <path d="M 304,208 L 304,304" fill="none" stroke="black"></path>
              <path d="M 320,64 L 320,224" fill="none" stroke="black"></path>
              <path d="M 320,256 L 320,320" fill="none" stroke="black"></path>
              <path d="M 168,48 L 256,48" fill="none" stroke="black"></path>
              <path d="M 104,64 L 160,64" fill="none" stroke="black"></path>
              <path d="M 264,64 L 320,64" fill="none" stroke="black"></path>
              <path d="M 120,80 L 168,80" fill="none" stroke="black"></path>
              <path d="M 256,80 L 304,80" fill="none" stroke="black"></path>
              <path d="M 136,96 L 168,96" fill="none" stroke="black"></path>
              <path d="M 256,96 L 288,96" fill="none" stroke="black"></path>
              <path d="M 168,112 L 256,112" fill="none" stroke="black"></path>
              <path d="M 24,176 L 96,176" fill="none" stroke="black"></path>
              <path d="M 112,176 L 128,176" fill="none" stroke="black"></path>
              <path d="M 144,176 L 176,176" fill="none" stroke="black"></path>
              <path d="M 264,176 L 280,176" fill="none" stroke="black"></path>
              <path d="M 296,176 L 312,176" fill="none" stroke="black"></path>
              <path d="M 328,176 L 416,176" fill="none" stroke="black"></path>
              <path d="M 8,208 L 96,208" fill="none" stroke="black"></path>
              <path d="M 112,208 L 128,208" fill="none" stroke="black"></path>
              <path d="M 144,208 L 160,208" fill="none" stroke="black"></path>
              <path d="M 248,208 L 280,208" fill="none" stroke="black"></path>
              <path d="M 296,208 L 312,208" fill="none" stroke="black"></path>
              <path d="M 328,208 L 400,208" fill="none" stroke="black"></path>
              <path d="M 168,272 L 256,272" fill="none" stroke="black"></path>
              <path d="M 136,288 L 160,288" fill="none" stroke="black"></path>
              <path d="M 264,288 L 288,288" fill="none" stroke="black"></path>
              <path d="M 120,304 L 168,304" fill="none" stroke="black"></path>
              <path d="M 256,304 L 304,304" fill="none" stroke="black"></path>
              <path d="M 104,320 L 168,320" fill="none" stroke="black"></path>
              <path d="M 264,320 L 320,320" fill="none" stroke="black"></path>
              <path d="M 168,336 L 256,336" fill="none" stroke="black"></path>
              <path d="M 8,208 L 24,176" fill="none" stroke="black"></path>
              <path d="M 160,208 L 176,176" fill="none" stroke="black"></path>
              <path d="M 248,208 L 264,176" fill="none" stroke="black"></path>
              <path d="M 400,208 L 416,176" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="272,320 260,314.4 260,325.6" fill="black" transform="rotate(180,264,320)"></polygon>
              <polygon class="arrowhead" points="272,288 260,282.4 260,293.6" fill="black" transform="rotate(180,264,288)"></polygon>
              <polygon class="arrowhead" points="272,64 260,58.4 260,69.6" fill="black" transform="rotate(180,264,64)"></polygon>
              <polygon class="arrowhead" points="168,288 156,282.4 156,293.6" fill="black" transform="rotate(0,160,288)"></polygon>
              <polygon class="arrowhead" points="168,64 156,58.4 156,69.6" fill="black" transform="rotate(0,160,64)"></polygon>
              <g class="text">
                <text x="112" y="36">new</text>
                <text x="312" y="36">old</text>
                <text x="116" y="52">path</text>
                <text x="308" y="52">path</text>
                <text x="212" y="84">Receiver</text>
                <text x="48" y="132">path-</text>
                <text x="104" y="132">4</text>
                <text x="224" y="132">path-</text>
                <text x="288" y="132">1</text>
                <text x="60" y="148">response</text>
                <text x="240" y="148">challenge</text>
                <text x="52" y="196">AP/NAT</text>
                <text x="88" y="196">A</text>
                <text x="356" y="196">AP/NAT</text>
                <text x="392" y="196">B</text>
                <text x="136" y="244">3</text>
                <text x="168" y="244">path-</text>
                <text x="320" y="244">2</text>
                <text x="352" y="244">path-</text>
                <text x="184" y="260">challenge</text>
                <text x="348" y="260">drop</text>
                <text x="212" y="308">Sender</text>
              </g>
            </svg><a href="#section-5-12.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-old-path-is-not-preferred" class="selfRef">Old path is not preferred</a>
        </figcaption></figure>
</div>
<p id="section-5-13">Case 3: The old path is alive and preferred.<a href="#section-5-13" class="pilcrow">¶</a></p>
<p id="section-5-14">This is most likely the result of an off-path attacker trying to place itself
on path.  The receiver sends a <code>path_challenge</code> on the old path and the sender
replies with a <code>path_response</code> (2) on the old path. The interaction is shown in
<a href="#fig-old-path-preferred" class="xref">Figure 4</a>. This results in the connection not being migrated
to the new path, thus thwarting the attack.<a href="#section-5-14" class="pilcrow">¶</a></p>
<span id="name-old-path-is-preferred"></span><div id="fig-old-path-preferred">
<figure id="figure-4">
        <div id="section-5-15.1">
          <div class="alignCenter art-svg artwork" id="section-5-15.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="384" width="352" viewBox="0 0 352 384" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 64,80 L 64,176" fill="none" stroke="black"></path>
              <path d="M 64,224 L 64,320" fill="none" stroke="black"></path>
              <path d="M 112,48 L 112,112" fill="none" stroke="black"></path>
              <path d="M 112,288 L 112,352" fill="none" stroke="black"></path>
              <path d="M 200,48 L 200,112" fill="none" stroke="black"></path>
              <path d="M 200,288 L 200,352" fill="none" stroke="black"></path>
              <path d="M 232,96 L 232,240" fill="none" stroke="black"></path>
              <path d="M 232,272 L 232,304" fill="none" stroke="black"></path>
              <path d="M 248,80 L 248,176" fill="none" stroke="black"></path>
              <path d="M 248,208 L 248,320" fill="none" stroke="black"></path>
              <path d="M 264,64 L 264,112" fill="none" stroke="black"></path>
              <path d="M 264,144 L 264,336" fill="none" stroke="black"></path>
              <path d="M 112,48 L 200,48" fill="none" stroke="black"></path>
              <path d="M 200,64 L 264,64" fill="none" stroke="black"></path>
              <path d="M 64,80 L 112,80" fill="none" stroke="black"></path>
              <path d="M 200,80 L 248,80" fill="none" stroke="black"></path>
              <path d="M 208,96 L 232,96" fill="none" stroke="black"></path>
              <path d="M 112,112 L 200,112" fill="none" stroke="black"></path>
              <path d="M 32,176 L 120,176" fill="none" stroke="black"></path>
              <path d="M 208,176 L 224,176" fill="none" stroke="black"></path>
              <path d="M 240,176 L 256,176" fill="none" stroke="black"></path>
              <path d="M 272,176 L 312,176" fill="none" stroke="black"></path>
              <path d="M 192,208 L 224,208" fill="none" stroke="black"></path>
              <path d="M 240,208 L 256,208" fill="none" stroke="black"></path>
              <path d="M 272,208 L 296,208" fill="none" stroke="black"></path>
              <path d="M 8,224 L 96,224" fill="none" stroke="black"></path>
              <path d="M 112,288 L 200,288" fill="none" stroke="black"></path>
              <path d="M 200,304 L 232,304" fill="none" stroke="black"></path>
              <path d="M 64,320 L 112,320" fill="none" stroke="black"></path>
              <path d="M 200,320 L 248,320" fill="none" stroke="black"></path>
              <path d="M 208,336 L 264,336" fill="none" stroke="black"></path>
              <path d="M 112,352 L 200,352" fill="none" stroke="black"></path>
              <path d="M 8,224 L 32,176" fill="none" stroke="black"></path>
              <path d="M 96,224 L 120,176" fill="none" stroke="black"></path>
              <path d="M 192,208 L 208,176" fill="none" stroke="black"></path>
              <path d="M 296,208 L 312,176" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="216,336 204,330.4 204,341.6" fill="black" transform="rotate(180,208,336)"></polygon>
              <polygon class="arrowhead" points="216,96 204,90.4 204,101.6" fill="black" transform="rotate(180,208,96)"></polygon>
              <g class="text">
                <text x="72" y="36">new</text>
                <text x="256" y="36">old</text>
                <text x="76" y="52">path</text>
                <text x="252" y="52">path</text>
                <text x="156" y="84">Receiver</text>
                <text x="264" y="132">1</text>
                <text x="296" y="132">path-</text>
                <text x="312" y="148">challenge</text>
                <text x="68" y="196">off-path</text>
                <text x="220" y="196">AP</text>
                <text x="248" y="196">/</text>
                <text x="280" y="196">NAT</text>
                <text x="60" y="212">attacker</text>
                <text x="176" y="260">path-</text>
                <text x="232" y="260">2</text>
                <text x="188" y="276">response</text>
                <text x="156" y="324">Sender</text>
              </g>
            </svg><a href="#section-5-15.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-old-path-is-preferred" class="selfRef">Old path is preferred</a>
        </figcaption></figure>
</div>
<p id="section-5-16">Note that this defense is imperfect, but this is not considered a serious
problem. If the path via the attack is reliably faster than the
old path despite multiple attempts to use that old path, it
is not possible to distinguish between an attack and an improvement
in routing.<a href="#section-5-16" class="pilcrow">¶</a></p>
<p id="section-5-17">An endpoint could also use heuristics to improve detection of this
style of attack. For instance, NAT rebinding is improbable if
packets were recently received on the old path; similarly, rebinding
is rare on IPv6 paths. Endpoints can also look for duplicated
packets. Conversely, a change in connection ID is more likely to
indicate an intentional migration rather than an attack. Note that
changes in connection IDs are supported in DTLS 1.3 but not in
DTLS 1.2.<a href="#section-5-17" class="pilcrow">¶</a></p>
</section>
</div>
<div id="regular">
<section id="section-6">
      <h2 id="name-path-validation-procedure">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-path-validation-procedure" class="section-name selfRef">Path Validation Procedure</a>
      </h2>
<p id="section-6-1">Note: This algorithm does not take the <a href="#off-path" class="xref">Section 5</a> scenario into account.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The receiver that observes the peer's address or port update <span class="bcp14">MUST</span> stop sending
any buffered application data (or limit the data sent to the unvalidated
address to the anti-amplification limit) and initiate the return routability
check that proceeds as follows:<a href="#section-6-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6-3">
<li id="section-6-3.1">The receiver creates a <code>return_routability_check</code> message of
type <code>path_challenge</code> and places the unpredictable cookie into the message.<a href="#section-6-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-6-3.2">The message is sent to the observed new address and a timer T (see
<a href="#timer-choice" class="xref">Section 7.3</a>) is started.<a href="#section-6-3.2" class="pilcrow">¶</a>
</li>
        <li id="section-6-3.3">The peer endpoint, after successfully verifying the received
<code>return_routability_check</code> message responds by echoing the cookie value in a
<code>return_routability_check</code> message of type <code>path_response</code>.<a href="#section-6-3.3" class="pilcrow">¶</a>
</li>
        <li id="section-6-3.4">When the initiator receives and verifies the <code>return_routability_check</code>
message contains the sent cookie, it updates the peer address binding.<a href="#section-6-3.4" class="pilcrow">¶</a>
</li>
        <li id="section-6-3.5">If T expires, or the address confirmation fails, the peer address binding is
not updated.<a href="#section-6-3.5" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-6-4">After this point, any pending send operation is resumed to the bound peer
address.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5"><a href="#path-challenge-reqs" class="xref">Section 7.1</a> and <a href="#path-response-reqs" class="xref">Section 7.2</a> contain the requirements for
the initiator and responder roles, broken down per protocol phase.<a href="#section-6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="enhanced">
<section id="section-7">
      <h2 id="name-enhanced-path-validation-pr">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-enhanced-path-validation-pr" class="section-name selfRef">Enhanced Path Validation Procedure</a>
      </h2>
<p id="section-7-1">Note: This algorithm also takes the <a href="#off-path" class="xref">Section 5</a> scenario into account.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The receiver that observes the peer's address or port update <span class="bcp14">MUST</span> stop sending
any buffered application data (or limit the data sent to the unvalidated
address to the anti-amplification limit) and initiate the return routability
check that proceeds as follows:<a href="#section-7-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7-3">
<li id="section-7-3.1">The receiver creates a <code>return_routability_check</code> message of
type <code>path_challenge</code> and places the unpredictable cookie into the message.<a href="#section-7-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-7-3.2">The message is sent to the previously valid address, which corresponds to the
old path. Additionally, a timer T, see <a href="#timer-choice" class="xref">Section 7.3</a>, is started.<a href="#section-7-3.2" class="pilcrow">¶</a>
</li>
        <li id="section-7-3.3">
          <p id="section-7-3.3.1">The peer endpoint verifies the received <code>return_routability_check</code> message.
The action to be taken depends on the preference of the path through which
the message was received:<a href="#section-7-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-3.3.2.1">If the path through which the message was received is preferred,
a <code>return_routability_check</code> message of type <code>path_response</code> <span class="bcp14">MUST</span> be returned.<a href="#section-7-3.3.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7-3.3.2.2">If the path through which the message was received is not preferred,
a <code>return_routability_check</code> message of type <code>path_drop</code> <span class="bcp14">MUST</span> be returned.
In either case, the peer endpoint echoes the cookie value in the response.<a href="#section-7-3.3.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li id="section-7-3.4">
          <p id="section-7-3.4.1">The initiator receives and verifies that the <code>return_routability_check</code>
message contains the previously sent cookie. The actions taken by the
initiator differ based on the received message:<a href="#section-7-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-3.4.2.1">When a <code>return_routability_check</code> message of type <code>path_response</code> was received,
the initiator <span class="bcp14">MUST</span> continue using the previously valid address, i.e. no switch
to the new path takes place and the peer address binding is not updated.<a href="#section-7-3.4.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7-3.4.2.2">When a <code>return_routability_check</code> message of type <code>path_drop</code> was received,
the initiator <span class="bcp14">MUST</span> perform a return routability check on the observed new
address, as described in <a href="#regular" class="xref">Section 6</a>.<a href="#section-7-3.4.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li id="section-7-3.5">If T expires, or the address confirmation fails, the peer address binding is
not updated. In this case, the initiator <span class="bcp14">MUST</span> perform a return routability
check on the observed new address, as described in <a href="#regular" class="xref">Section 6</a>.<a href="#section-7-3.5" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-7-4">After the path validation procedure is completed, any pending send operation is
resumed to the bound peer address.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5"><a href="#path-challenge-reqs" class="xref">Section 7.1</a> and <a href="#path-response-reqs" class="xref">Section 7.2</a> contain the requirements for
the initiator and responder roles, broken down per protocol phase.<a href="#section-7-5" class="pilcrow">¶</a></p>
<div id="path-challenge-reqs">
<section id="section-7.1">
        <h3 id="name-path-challenge-requirements">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-path-challenge-requirements" class="section-name selfRef">Path Challenge Requirements</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-7.1-1.1">
            <p id="section-7.1-1.1.1">The initiator <span class="bcp14">MAY</span> send multiple <code>return_routability_check</code> messages of type
<code>path_challenge</code> to cater for packet loss on the probed path.<a href="#section-7.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-1.1.2.1">Each <code>path_challenge</code> <span class="bcp14">SHOULD</span> go into different transport packets.  (Note that
the DTLS implementation may not have control over the packetization done by
the transport layer.)<a href="#section-7.1-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.1-1.1.2.2">The transmission of subsequent <code>path_challenge</code> messages <span class="bcp14">SHOULD</span> be paced to
decrease the chance of loss.<a href="#section-7.1-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.1-1.1.2.3">Each <code>path_challenge</code> message <span class="bcp14">MUST</span> contain random data.<a href="#section-7.1-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.1-1.2">The initiator <span class="bcp14">MAY</span> use padding using the record padding mechanism available in
DTLS 1.3 (and in DTLS 1.2, when CID is enabled on the sending direction) up
to the anti-amplification limit to probe if the path MTU (PMTU) for the new
path is still acceptable.<a href="#section-7.1-1.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="path-response-reqs">
<section id="section-7.2">
        <h3 id="name-path-response-drop-requirem">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-path-response-drop-requirem" class="section-name selfRef">Path Response/Drop Requirements</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-7.2-1.1">The responder <span class="bcp14">MUST NOT</span> delay sending an elicited <code>path_response</code> or
<code>path_drop</code> messages.<a href="#section-7.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-1.2">The responder <span class="bcp14">MUST</span> send exactly one <code>path_response</code> or <code>path_drop</code> message
for each received <code>path_challenge</code>.<a href="#section-7.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-1.3">The responder <span class="bcp14">MUST</span> send the <code>path_response</code> or the <code>path_drop</code> on the path
where the corresponding <code>path_challenge</code> has been received, so that validation
succeeds only if the path is functional in both directions. The initiator
<span class="bcp14">MUST NOT</span> enforce this behaviour.<a href="#section-7.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-1.4">The initiator <span class="bcp14">MUST</span> silently discard any invalid <code>path_response</code> it receives.<a href="#section-7.2-1.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.2-2">Note that RRC does not cater for PMTU discovery on the reverse path.  If the
responder wants to do PMTU discovery using RRC, it should initiate a new path
validation procedure.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="timer-choice">
<section id="section-7.3">
        <h3 id="name-timer-choice">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-timer-choice" class="section-name selfRef">Timer Choice</a>
        </h3>
<p id="section-7.3-1">When setting T, implementations are cautioned that the new path could have a
longer round-trip time (RTT) than the original.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">In settings where there is external information about the RTT of the active
path, implementations <span class="bcp14">SHOULD</span> use T = 3xRTT.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">If an implementation has no way to obtain information regarding the RTT of the
active path, a value of 1s <span class="bcp14">SHOULD</span> be used.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">Profiles for specific deployment environments -- for example, constrained
networks <span>[<a href="#I-D.ietf-uta-tls13-iot-profile" class="xref">I-D.ietf-uta-tls13-iot-profile</a>]</span> -- <span class="bcp14">MAY</span> specify a different, more
suitable value.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="example">
<section id="section-8">
      <h2 id="name-example">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-example" class="section-name selfRef">Example</a>
      </h2>
<p id="section-8-1">The example TLS 1.3 handshake shown in <a href="#fig-handshake" class="xref">Figure 5</a> shows a client
and a server negotiating the support for CID and for the RRC extension.<a href="#section-8-1" class="pilcrow">¶</a></p>
<span id="name-message-flow-for-full-tls-h"></span><div id="fig-handshake">
<figure id="figure-5">
        <div class="alignLeft art-text artwork" id="section-8-2.1">
<pre>
       Client                                           Server

Key  ^ ClientHello
Exch | + key_share
     | + signature_algorithms
     | + rrc
     v + connection_id=empty
                               --------&gt;
                                                  ServerHello  ^ Key
                                                 +  key_share  | Exch
                                          + connection_id=100  |
                                                        + rrc  v
                                        {EncryptedExtensions}  ^  Server
                                         {CertificateRequest}  v  Params
                                                {Certificate}  ^
                                          {CertificateVerify}  | Auth
                               &lt;--------           {Finished}  v

     ^ {Certificate}
Auth | {CertificateVerify}
     v {Finished}              --------&gt;
       [Application Data]      &lt;-------&gt;  [Application Data]

              +  Indicates noteworthy extensions sent in the
                 previously noted message.

              *  Indicates optional or situation-dependent
                 messages/extensions that are not always sent.

              {} Indicates messages protected using keys
                 derived from a [sender]_handshake_traffic_secret.

              [] Indicates messages protected using keys
                 derived from [sender]_application_traffic_secret_N.
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-message-flow-for-full-tls-h" class="selfRef">Message Flow for Full TLS Handshake</a>
        </figcaption></figure>
</div>
<p id="section-8-3">Once a connection has been established the client and the server
exchange application payloads protected by DTLS with an unilaterally used
CIDs. In our case, the client is requested to use CID 100 for records
sent to the server.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">At some point in the communication interaction the IP address used by
the client changes and, thanks to the CID usage, the security context to
interpret the record is successfully located by the server.  However, the
server wants to test the reachability of the client at his new IP address.<a href="#section-8-4" class="pilcrow">¶</a></p>
<span id="name-return-routability-example"></span><div id="fig-rrc-example">
<figure id="figure-6">
        <div class="alignLeft art-text artwork" id="section-8-5.1">
<pre>
      Client                                             Server
      ------                                             ------

      Application Data            ========&gt;
      &lt;CID=100&gt;
      Src-IP=A
      Dst-IP=Z
                                  &lt;========        Application Data
                                                       Src-IP=Z
                                                       Dst-IP=A


                              &lt;&lt;-------------&gt;&gt;
                              &lt;&lt;   Some      &gt;&gt;
                              &lt;&lt;   Time      &gt;&gt;
                              &lt;&lt;   Later     &gt;&gt;
                              &lt;&lt;-------------&gt;&gt;


      Application Data            ========&gt;
      &lt;CID=100&gt;
      Src-IP=B
      Dst-IP=Z

                                             &lt;&lt;&lt; Unverified IP
                                                 Address B &gt;&gt;

                                  &lt;--------  Return Routability Check
                                             path_challenge(cookie)
                                                    Src-IP=Z
                                                    Dst-IP=B

      Return Routability Check    --------&gt;
      path_response(cookie)
      Src-IP=B
      Dst-IP=Z

                                             &lt;&lt;&lt; IP Address B
                                                 Verified &gt;&gt;


                                  &lt;========        Application Data
                                                       Src-IP=Z
                                                       Dst-IP=B
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-return-routability-example" class="selfRef">Return Routability Example</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="security-and-privacy-considerations">
<section id="section-9">
      <h2 id="name-security-and-privacy-consid">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-and-privacy-consid" class="section-name selfRef">Security and Privacy Considerations</a>
      </h2>
<p id="section-9-1">Note that the return routability checks do not protect against flooding of
third-parties if the attacker is on-path, as the attacker can redirect the
return routability checks to the real peer (even if those datagrams are
cryptographically authenticated).  On-path adversaries can, in general, pose a
harm to connectivity.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1"><span class="cref" id="to-be-removed">RFC Editor: please replace RFCthis with this RFC number and remove this note.</span><a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="new-tls-contenttype">
<section id="section-10.1">
        <h3 id="name-new-tls-contenttype">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-new-tls-contenttype" class="section-name selfRef">New TLS ContentType</a>
        </h3>
<p id="section-10.1-1">IANA is requested to allocate an entry to the TLS <code>ContentType</code>
registry, for the <code>return_routability_check(TBD2)</code> message defined in
this document. The <code>return_routability_check</code> content type is only
applicable to DTLS 1.2 and 1.3.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-tls-extensiontype">
<section id="section-10.2">
        <h3 id="name-new-tls-extensiontype">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-new-tls-extensiontype" class="section-name selfRef">New TLS ExtensionType</a>
        </h3>
<p id="section-10.2-1">IANA is requested to allocate the extension code point (TBD1) for the <code>rrc</code>
extension to the <code>TLS ExtensionType Values</code> registry as described in
<a href="#tbl-ext" class="xref">Table 1</a>.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<span id="name-rrc-entry-in-the-tls-extens"></span><div id="tbl-ext">
<table class="left" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-rrc-entry-in-the-tls-extens" class="selfRef">rrc entry in the TLS ExtensionType Values registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Extension Name</th>
              <th class="text-left" rowspan="1" colspan="1">TLS 1.3</th>
              <th class="text-left" rowspan="1" colspan="1">DTLS-Only</th>
              <th class="text-left" rowspan="1" colspan="1">Recommended</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD1</td>
              <td class="text-left" rowspan="1" colspan="1">rrc</td>
              <td class="text-left" rowspan="1" colspan="1">CH, SH</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="new-rrc-message-type-sub-registry">
<section id="section-10.3">
        <h3 id="name-new-rrc-message-type-sub-re">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-new-rrc-message-type-sub-re" class="section-name selfRef">New RRC Message Type Sub-registry</a>
        </h3>
<p id="section-10.3-1">IANA is requested to create a new sub-registry for RRC Message Types in the TLS
Parameters registry <span>[<a href="#IANA.tls-parameters" class="xref">IANA.tls-parameters</a>]</span>, with the policy "expert review"
<span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2">Each entry in the registry must include:<a href="#section-10.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-10.3-3">
          <dt id="section-10.3-3.1">Value</dt>
          <dd style="margin-left: 1.5em" id="section-10.3-3.2">
            <p id="section-10.3-3.2.1">A number in the range from 0 to 255 (decimal)<a href="#section-10.3-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-3.3">Description:</dt>
          <dd style="margin-left: 1.5em" id="section-10.3-3.4">
            <p id="section-10.3-3.4.1">a brief description of the message<a href="#section-10.3-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-3.5">DTLS-Only:</dt>
          <dd style="margin-left: 1.5em" id="section-10.3-3.6">
            <p id="section-10.3-3.6.1">RRC is only available in DTLS, therefore this column will be set to <code>Y</code> for
all the entries in this registry<a href="#section-10.3-3.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-3.7">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-10.3-3.8">
            <p id="section-10.3-3.8.1">a reference document<a href="#section-10.3-3.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.3-4">The initial state of this sub-registry is as follows:<a href="#section-10.3-4" class="pilcrow">¶</a></p>
<span id="name-initial-entries-in-rrc-mess"></span><div id="tbl-rrc-mt">
<table class="left" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-initial-entries-in-rrc-mess" class="selfRef">Initial Entries in RRC Message Type registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">DTLS-Only</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">path_challenge</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">path_response</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">path_drop</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3-255</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="open-issues">
<section id="section-11">
      <h2 id="name-open-issues">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-open-issues" class="section-name selfRef">Open Issues</a>
      </h2>
<p id="section-11-1">Issues against this document are tracked at https://github.com/tlswg/dtls-rrc/issues<a href="#section-11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="section-12">
      <h2 id="name-acknowledgments">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-12-1">We would like to thank
Achim Kraus,
Hanno Becker,
Hanno Boeck,
Manuel Pegourie-Gonnard,
Mohit Sahni and
Rich Salz
for their input to this document.<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="IANA.tls-parameters">[IANA.tls-parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Transport Layer Security (TLS) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/tls-parameters">https://www.iana.org/assignments/tls-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9146">[RFC9146]</dt>
        <dd>
<span class="refAuthor">Rescorla, E., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">A. Kraus</span>, <span class="refTitle">"Connection Identifier for DTLS 1.2"</span>, <span class="seriesInfo">RFC 9146</span>, <span class="seriesInfo">DOI 10.17487/RFC9146</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9146">https://www.rfc-editor.org/rfc/rfc9146</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-uta-tls13-iot-profile">[I-D.ietf-uta-tls13-iot-profile]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"TLS/DTLS 1.3 Profiles for the Internet of Things"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-uta-tls13-iot-profile-04</span>, <time datetime="2022-03-07" class="refDate">7 March 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-uta-tls13-iot-profile-04">https://datatracker.ietf.org/doc/html/draft-ietf-uta-tls13-iot-profile-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
      <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="history">
<section id="appendix-A">
      <h2 id="name-history">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-history" class="section-name selfRef">History</a>
      </h2>
<p id="appendix-A-1"><span class="cref">RFC EDITOR: PLEASE REMOVE THIS SECTION</span><a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">draft-ietf-tls-dtls-rrc-05<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-3.1">Added text about off-path packet forwarding<a href="#appendix-A-3.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-4">draft-ietf-tls-dtls-rrc-04<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-5.1">Re-submitted draft to fix references<a href="#appendix-A-5.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-6">draft-ietf-tls-dtls-rrc-03<a href="#appendix-A-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-7.1">Added details for challenge-response exchange<a href="#appendix-A-7.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-8">draft-ietf-tls-dtls-rrc-02<a href="#appendix-A-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-9.1">Undo the TLS flags extension for negotiating RRC, use a new extension type<a href="#appendix-A-9.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-10">draft-ietf-tls-dtls-rrc-01<a href="#appendix-A-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-11.1">Use the TLS flags extension for negotiating RRC<a href="#appendix-A-11.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-11.2">Enhanced IANA consideration section<a href="#appendix-A-11.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-11.3">Expanded example section<a href="#appendix-A-11.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-11.4">
          <p id="appendix-A-11.4.1">Revamp message layout:<a href="#appendix-A-11.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-11.4.2.1">Use 8-byte fixed size cookies<a href="#appendix-A-11.4.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A-11.4.2.2">Explicitly separate path challenge from response<a href="#appendix-A-11.4.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="appendix-A-12">draft-ietf-tls-dtls-rrc-00<a href="#appendix-A-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-13.1">Draft name changed after WG adoption<a href="#appendix-A-13.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-14">draft-tschofenig-tls-dtls-rrc-01<a href="#appendix-A-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-15.1">Removed text that overlapped with draft-ietf-tls-dtls-connection-id<a href="#appendix-A-15.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-16">draft-tschofenig-tls-dtls-rrc-00<a href="#appendix-A-16" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-17.1">Initial version<a href="#appendix-A-17.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hannes.tschofenig@arm.com" class="email">hannes.tschofenig@arm.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thomas Fossati</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:thomas.fossati@arm.com" class="email">thomas.fossati@arm.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
